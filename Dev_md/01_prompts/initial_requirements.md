# 📋 Nong-View2 초기 요구사항 프롬프트

## 원본 요구사항

### 프로젝트 개요
지리정보 기반 AI 분석 파이프라인 개발 요구사항

### 전체 아키텍처
6단계 POD(Process-Oriented Design) 구조로 구성된 지리정보 분석 파이프라인을 구현해야 합니다. 각 POD는 독립적으로 실행 가능하며 순차적으로 데이터를 처리합니다.

## POD별 상세 요구사항

### POD 1: 파일 가져오기 (데이터 관리)
**입력**: 정사영상 TIF/ECW 파일 가져오기 (ECW → TIF 변환처리)

**처리 로직**:
- Shapefile 형태의 분석 영역 입력
- PNU 기반 필지 Geometry 처리 (공간정보 업로드)
- 필지별 Geometry 추출 및 저장

### POD 2: 크롭핑
**입력**: 정사영상 원본

**처리 로직**:
- 영역 추출 후 Convex Hull 알고리즘 적용 (최소경계사각형 생성)
- 정사영상과 Shapefile의 좌표계 일치 확인
- 크롭된 영역을 다음 단계로 전달

### POD 3: 타일링
**처리 방식**:
- 입력 데이터를 1024x1024 픽셀 크기로 분할
- TIF 형식으로 타일 저장 (ecw/jpg 확장자 지원)
- 겹침(overlap) 설정 가능:
  - 타일링 또는 필지 전체 분석 옵션
  - 적응형 타일링 기능 구현
- 액셀파일 활용: PNU 및 지번 기반 연속 지적도 매칭
- 필지 단위 Convex Hull 적용 (최소경계사각형 추출)

### POD 4: AI 분석
**YOLOv11-seg 모델 구성**:

6개 클래스 분류 (예산 기준):
1. 생육기 사료작물(IRG, 호밀, 수단그라스, 옥수수) - 1500개 × 6000개
2. 생산기 사료작물(IRG, 호밀, 수단그라스, 옥수수) - 1500개 × 6000개
3. 곤포 사일리지(개수 파악 필요) - 2000개
4. 비닐하우스(단동/연동 구분) - 1500개
5. 경작유무(드론영상) - 1500개
6. 경작유무(위성영상) - 3000개

**기술 구현**:
- YOLO v11 Detection + Segmentation 분석 실행
- JSON 형식으로 결과 저장 (좌표계, 클래스 등 메타데이터 포함)
- 파라미터, 훈련 데이터셋 분할, 데이터 증강 최적화
- 품질 필터 적용 (정상영상 제작 시 검수)

### POD 5: 병합
**처리 로직**:
- AI 추론 결과와 동일한 클래스 판별 결과 통합
- 병합 처리 알고리즘 구현
- 분석 결과 병합 및 공간정보 맵핑
- 추론 최적화: 메모리, 후처리 등 타일링 추론 방식 조정
- 필지 추론 방식과 표출 최적화

### POD 6: GPKG 발행
**최종 처리**:
- GeoPackage 출력 및 가시화
- 화면 캡처 기능 (행정정보 리포팅/통계 기능 개발)
- 분석 결과 연속지적도 기반 clip 면적 산정 기능 구현

## 추가 기술 요구사항

1. 모든 POD는 모듈화되어 독립 실행 가능해야 함
2. 각 단계별 로그 및 에러 처리 구현
3. 대용량 이미지 처리를 위한 메모리 최적화
4. 병렬 처리 지원 (타일링 및 AI 분석 단계)
5. 좌표계 변환 및 공간정보 처리 정확도 보장

## 구현 목표

이 파이프라인을 Python 기반으로 구현하되, 각 POD를 독립적인 모듈로 개발하고 전체를 통합하는 메인 스크립트를 작성해주세요.